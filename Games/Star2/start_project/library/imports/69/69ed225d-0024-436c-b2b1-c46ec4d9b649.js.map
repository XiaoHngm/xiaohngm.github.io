{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Star.js"],"names":["cc","Class","extends","Component","properties","maxStarDuration","minStarDuration","minOpacity","targetDisappearX","targetDisappearY","onLoad","starDuration","Math","random","timer","start","update","dt","opacityRatio","node","opacity","floor","setPickedAction","animationDuration","ceil","hypot","x","y","rotate","rotateBy","flyAway","bezierBy","v2","easing","easeCubicActionIn","zoomOut","scaleTo","disappear","fadeTo","spawn"],"mappings":";;;;;;AAGAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,yBAAiB,CADT,EACW;AACnBC,yBAAiB,CAFT;AAGRC,oBAAY,EAHJ,EAGO;AACfC,0BAAkB,CAJV;AAKRC,0BAAkB;AALV,KAHP;;AAWLC,YAAQ,kBAAY;AAChB,aAAKC,YAAL,GAAoB,KAAKL,eAAL,GAAuBM,KAAKC,MAAL,MAAiB,KAAKR,eAAL,GAAuB,KAAKC,eAA7C,CAA3C;AACA,aAAKQ,KAAL,GAAa,CAAb;AACH,KAdI;;AAgBLC,WAAO,iBAAY,CAElB,CAlBI;;AAoBLC,YAAQ,gBAAUC,EAAV,EAAc;AAClB;AACA,aAAKH,KAAL,IAAcG,EAAd;AACA,YAAIC,eAAe,IAAI,KAAKJ,KAAL,GAAW,KAAKH,YAAvC;AACA,aAAKQ,IAAL,CAAUC,OAAV,GAAoB,KAAKb,UAAL,GAAkBK,KAAKS,KAAL,CAAWH,gBAAgB,MAAM,KAAKX,UAA3B,CAAX,CAAtC;AACH,KAzBI;;AA2BLe,qBAAiB,2BAAY;AACzB;AACA,YAAIC,oBAAoB,QAAMX,KAAKY,IAAL,CAAUZ,KAAKa,KAAL,CAChC,KAAKN,IAAL,CAAUO,CAAV,GAAY,KAAKlB,gBADe,EAEhC,KAAKW,IAAL,CAAUQ,CAAV,GAAY,KAAKlB,gBAFe,CAAV,CAA9B;AAGA;AACA,YAAImB,MAAJ;AACA,YAAI,KAAKT,IAAL,CAAUO,CAAV,GAAc,KAAKlB,gBAAvB,EAAyC;AACrC,gBAAI,KAAKW,IAAL,CAAUC,OAAV,GAAoB,GAAxB,EAA6B;AACzBQ,yBAAS5B,GAAG6B,QAAH,CAAYN,iBAAZ,EAA+B,KAA/B,CAAT;AACH,aAFD,MAEO;AACHK,yBAAS5B,GAAG6B,QAAH,CAAYN,iBAAZ,EAA+B,KAA/B,CAAT;AACH;AACJ,SAND,MAMO;AACH,gBAAI,KAAKJ,IAAL,CAAUC,OAAV,GAAoB,GAAxB,EAA6B;AACzBQ,yBAAS5B,GAAG6B,QAAH,CAAYN,iBAAZ,EAA+B,CAAC,KAAhC,CAAT;AACH,aAFD,MAEO;AACHK,yBAAS5B,GAAG6B,QAAH,CAAYN,iBAAZ,EAA+B,CAAC,KAAhC,CAAT;AACH;AACJ;AACD;AACA,YAAIO,UAAU9B,GAAG+B,QAAH,CAAYR,iBAAZ,EAA+B,CACrCvB,GAAGgC,EAAH,CAAM,CAAN,EAAS,CAAT,CADqC,EAErChC,GAAGgC,EAAH,CAAM,OAAK,KAAKxB,gBAAL,GAAsB,KAAKW,IAAL,CAAUO,CAArC,CAAN,EACM,KAAKjB,gBADX,CAFqC,EAIrCT,GAAGgC,EAAH,CAAM,KAAKxB,gBAAL,GAAsB,KAAKW,IAAL,CAAUO,CAAtC,EACM,KAAKjB,gBAAL,GAAsB,KAAKU,IAAL,CAAUQ,CADtC,CAJqC,CAA/B,EAMXM,MANW,CAMJjC,GAAGkC,iBAAH,EANI,CAAd;AAOA;AACA,YAAIC,UAAUnC,GAAGoC,OAAH,CAAWb,iBAAX,EAA8B,GAA9B,CAAd;AACA;AACA,YAAIc,YAAYrC,GAAGsC,MAAH,CAAUf,iBAAV,EAA6B,GAA7B,CAAhB;;AAEA,eAAOvB,GAAGuC,KAAH,CAASX,MAAT,EAAiBE,OAAjB,EAA0BK,OAA1B,EAAmCE,SAAnC,CAAP;AACH;AA7DI,CAAT","file":"Star.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        maxStarDuration: 5,// 星星产生后消失时间的随机范围\r\n        minStarDuration: 3,\r\n        minOpacity: 50,//星星的透明度最小值\r\n        targetDisappearX: 0,\r\n        targetDisappearY: 240,\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    },\r\n\r\n    start: function () {\r\n\r\n    },\r\n\r\n    update: function (dt) {\r\n        // 根据 Game 脚本中的计时器更新星星的透明度\r\n        this.timer += dt;\r\n        var opacityRatio = 1 - this.timer/this.starDuration;\r\n        this.node.opacity = this.minOpacity + Math.floor(opacityRatio * (255 - this.minOpacity));\r\n    },\r\n\r\n    setPickedAction: function () {\r\n        // 时间间隔\r\n        var animationDuration = 0.002*Math.ceil(Math.hypot(\r\n                this.node.x-this.targetDisappearX,\r\n                this.node.y-this.targetDisappearY));\r\n        // 旋转\r\n        var rotate;\r\n        if (this.node.x < this.targetDisappearX) {\r\n            if (this.node.opacity < 150) {\r\n                rotate = cc.rotateBy(animationDuration, 144.0);\r\n            } else {\r\n                rotate = cc.rotateBy(animationDuration, 432.0);\r\n            }\r\n        } else {\r\n            if (this.node.opacity < 150) {\r\n                rotate = cc.rotateBy(animationDuration, -144.0);\r\n            } else {\r\n                rotate = cc.rotateBy(animationDuration, -432.0);\r\n            }\r\n        }\r\n        // 飞远\r\n        var flyAway = cc.bezierBy(animationDuration, [\r\n                cc.v2(0, 0),\r\n                cc.v2(0.5*(this.targetDisappearX-this.node.x),\r\n                      this.targetDisappearY),\r\n                cc.v2(this.targetDisappearX-this.node.x,\r\n                      this.targetDisappearY-this.node.y),\r\n        ]).easing(cc.easeCubicActionIn());\r\n        // 缩小\r\n        var zoomOut = cc.scaleTo(animationDuration, 0.5);\r\n        // 消失\r\n        var disappear = cc.fadeTo(animationDuration, 128);\r\n\r\n        return cc.spawn(rotate, flyAway, zoomOut, disappear);\r\n    },\r\n});\r\n"]}